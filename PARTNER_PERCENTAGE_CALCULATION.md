# ๐ ุฏููู ุญุณุงุจ ูุณุจุฉ ุงููุณุงููุฉ ููุดุฑูุงุก

## ๐ฏ ููู ูุชู ุญุณุงุจ ูุณุจุฉ ุงููุณุงููุฉุ

### ุทุฑููุฉ ุงูุญุณุงุจ ุงูุชููุงุฆู โ

ุงููุธุงู **ูุญุณุจ ุชููุงุฆูุงู** ูุณุจุฉ ูุณุงููุฉ ูู ุดุฑูู ุจูุงุกู ุนูู:

```javascript
ูุณุจุฉ ุงููุณุงููุฉ = (ูุจูุบ ูุณุงููุฉ ุงูุดุฑูู รท ุฅุฌูุงูู ุฑุฃุณ ุงููุงู ุงูุฌุฏูุฏ) ร 100
```

---

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1๏ธโฃ: ุฃูู ุดุฑูู

**ุงูุญุงูุฉ ุงูุงุจุชุฏุงุฆูุฉ:**
- ุฑุฃุณ ุงููุงู ุงูุญุงูู = `0` ุฌููู
- ูุง ููุฌุฏ ุดุฑูุงุก

**ุฅุถุงูุฉ ุงูุดุฑูู ุงูุฃูู (ุฃุญูุฏ):**
- ูุจูุบ ุงููุณุงููุฉ = `100,000` ุฌููู
- ุฅุฌูุงูู ุฑุฃุณ ุงููุงู ุงูุฌุฏูุฏ = `0 + 100,000 = 100,000` ุฌููู

**ุงูุญุณุงุจ:**
```
ูุณุจุฉ ุฃุญูุฏ = (100,000 รท 100,000) ร 100 = 100%
```

โ **ุงููุชูุฌุฉ:** ุฃุญูุฏ ูููู 100% ูู ุฑุฃุณ ุงููุงู

---

### ูุซุงู 2๏ธโฃ: ุดุฑูู ุซุงูู

**ุงูุญุงูุฉ ุงูุญุงููุฉ:**
- ุฑุฃุณ ุงููุงู = `100,000` ุฌููู
- ุฃุญูุฏ: 100% (`100,000` ุฌููู)

**ุฅุถุงูุฉ ุดุฑูู ุซุงูู (ูุญูุฏ):**
- ูุจูุบ ุงููุณุงููุฉ = `50,000` ุฌููู
- ุฅุฌูุงูู ุฑุฃุณ ุงููุงู ุงูุฌุฏูุฏ = `100,000 + 50,000 = 150,000` ุฌููู

**ุงูุญุณุงุจ:**
```
ูุณุจุฉ ูุญูุฏ = (50,000 รท 150,000) ร 100 = 33.33%
```

โ **ุงููุชูุฌุฉ:**
- ุฃุญูุฏ: `100,000 รท 150,000 = 66.67%` โฌ๏ธ (ุงูุฎูุถุช ูุณุจุชู)
- ูุญูุฏ: `33.33%` (ุงูุดุฑูู ุงูุฌุฏูุฏ)

โ๏ธ **ููุงุญุธุฉ:** ูุณุจุฉ ุงูุดุฑูุงุก ุงูุณุงุจููู **ูุง ุชูุญุฏููุซ ุชููุงุฆูุงู** ูู ุงููุธุงู ุงูุญุงูู!

---

### ูุซุงู 3๏ธโฃ: ุดุฑูู ุซุงูุซ

**ุงูุญุงูุฉ ุงูุญุงููุฉ:**
- ุฑุฃุณ ุงููุงู = `150,000` ุฌููู
- ุฃุญูุฏ: `100,000` ุฌููู
- ูุญูุฏ: `50,000` ุฌููู

**ุฅุถุงูุฉ ุดุฑูู ุซุงูุซ (ุนูู):**
- ูุจูุบ ุงููุณุงููุฉ = `100,000` ุฌููู
- ุฅุฌูุงูู ุฑุฃุณ ุงููุงู ุงูุฌุฏูุฏ = `150,000 + 100,000 = 250,000` ุฌููู

**ุงูุญุณุงุจ:**
```
ูุณุจุฉ ุนูู = (100,000 รท 250,000) ร 100 = 40%
```

โ **ุงููุณุจ ุงูุญููููุฉ:**
- ุฃุญูุฏ: `100,000 รท 250,000 = 40%`
- ูุญูุฏ: `50,000 รท 250,000 = 20%`
- ุนูู: `100,000 รท 250,000 = 40%`

---

## ๐ ูุง ูุญุฏุซ ูู ุงููุธุงู

### ุนูุฏ ุฅุถุงูุฉ ุดุฑูู ุฌุฏูุฏ:

```typescript
// 1. ุฌูุจ ุฑุฃุณ ุงููุงู ุงูุญุงูู
const currentTotalCapital = vendor.capitalBalance; // ูุซุงู: 150,000

// 2. ุญุณุงุจ ุฑุฃุณ ุงููุงู ุงูุฌุฏูุฏ
const newTotalCapital = currentTotalCapital + capitalAmount;
// ูุซุงู: 150,000 + 100,000 = 250,000

// 3. ุญุณุงุจ ูุณุจุฉ ุงูุดุฑูู ุงูุฌุฏูุฏ
const actualPercent = (capitalAmount / newTotalCapital) ร 100;
// ูุซุงู: (100,000 รท 250,000) ร 100 = 40%
```

---

## โ๏ธ ุงูุชุญุฐูุฑุงุช ูุงูููุงุญุธุงุช

### ๐ด ูุณุจ ุงูุดุฑูุงุก ุงููุฏุงูู ูุง ุชูุญุฏููุซ ุชููุงุฆูุงู

**ุงููุดููุฉ:**
- ุนูุฏ ุฅุถุงูุฉ ุดุฑูู ุฌุฏูุฏุ ุงููุธุงู **ูุง ููุญุฏูุซ** ูุณุจ ุงูุดุฑูุงุก ุงูุณุงุจููู
- ูุฌุจ ุชุญุฏูุซูุง ูุฏููุงู ุฃู ุจูุงุก ูุธุงู ุชุญุฏูุซ ุชููุงุฆู

**ูุซุงู:**
```
ุงููุถุน ุงูุณุงุจู:
- ุฃุญูุฏ: 100% (100,000 ุฌููู)

ุจุนุฏ ุฅุถุงูุฉ ูุญูุฏ (50,000 ุฌููู):
- ูู ุงููุธุงู:
  โ ูุญูุฏ: 33.33% (ุตุญูุญ)
  โ ุฃุญูุฏ: 100% (ุฎุทุฃ - ุงูููุฑูุถ 66.67%)

- ุงููุงูุน:
  โ ูุญูุฏ: 33.33%
  โ ุฃุญูุฏ: 66.67%
```

---

## โ ุงูุญู ุงูููุชุฑุญ

### ุฎูุงุฑ 1: ุชุญุฏูุซ ูุฏูู

ุงููุฏูุฑ ููุญุฏูุซ ูุณุจ ุฌููุน ุงูุดุฑูุงุก ุจุนุฏ ุฅุถุงูุฉ ุดุฑูู ุฌุฏูุฏ.

### ุฎูุงุฑ 2: ุชุญุฏูุซ ุชููุงุฆู (ููุตู ุจู)

ุฅุถุงูุฉ ุฏุงูุฉ ุชุญุณุจ ูุชูุญุฏูุซ ูุณุจ ุฌููุน ุงูุดุฑูุงุก:

```typescript
async function updateAllPartnersPercentages(vendorId: string) {
  // 1. ุฌูุจ ุฑุฃุณ ุงููุงู ุงูููู
  const vendor = await prisma.vendor.findUnique({
    where: { id: vendorId },
    select: { capitalBalance: true }
  });

  const totalCapital = vendor.capitalBalance;

  // 2. ุฌูุจ ุฌููุน ุงูุดุฑูุงุก
  const partners = await prisma.partnerCapital.findMany({
    where: { vendorId }
  });

  // 3. ุชุญุฏูุซ ูุณุจุฉ ูู ุดุฑูู
  for (const partner of partners) {
    const newPercent = (partner.capitalAmount / totalCapital) ร 100;
    
    await prisma.partnerCapital.update({
      where: { id: partner.id },
      data: { capitalPercent: newPercent }
    });
  }
}
```

---

## ๐ ููุฎุต ุณุฑูุน

| ุงููููู | ุงูุญุณุงุจ | ุงููุชูุฌุฉ |
|--------|---------|---------|
| ุดุฑูู ูุงุญุฏ (100,000 ุฌ) | `100,000 รท 100,000 ร 100` | 100% |
| + ุดุฑูู ุซุงูู (50,000 ุฌ) | `50,000 รท 150,000 ร 100` | 33.33% |
| + ุดุฑูู ุซุงูุซ (100,000 ุฌ) | `100,000 รท 250,000 ร 100` | 40% |

**ุฅุฌูุงูู ุฑุฃุณ ุงููุงู:**
- ุจุนุฏ ุงูุดุฑูู ุงูุฃูู: `100,000` ุฌ
- ุจุนุฏ ุงูุดุฑูู ุงูุซุงูู: `150,000` ุฌ
- ุจุนุฏ ุงูุดุฑูู ุงูุซุงูุซ: `250,000` ุฌ

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุญุณุงุจ

ุนูุฏ ุฅุถุงูุฉ ุดุฑูู ุฌุฏูุฏุ ุดุงูุฏ console.log:

```
๐ ุญุณุงุจ ูุณุจุฉ ุงููุณุงููุฉ:
   ุฑุฃุณ ุงููุงู ุงูุญุงูู: 150000 ุฌููู
   ูุณุงููุฉ ุงูุดุฑูู: 100000 ุฌููู
   ุฑุฃุณ ุงููุงู ุงูุฌุฏูุฏ: 250000 ุฌููู
   ุงููุณุจุฉ ุงูููุฏุฎูุฉ: 40%
   ุงููุณุจุฉ ุงููุญุณูุจุฉ: 40.00%
```

---

## ๐ก ูุตุงุฆุญ

1. **ุฑุงุฌุน ุงููุณุจ ุฏุงุฆูุงู** ุจุนุฏ ุฅุถุงูุฉ ุดุฑูู ุฌุฏูุฏ
2. **ุชุฃูุฏ ูู ุฌูุน ุงููุณุจ = 100%** ููุชุญูู ูู ุงูุตุญุฉ
3. **ุงุณุชุฎุฏู ุงูุญุงุณุจุฉ** ููุชุฃูุฏ ูู ุงูุญุณุงุจุงุช
4. **ูุซูู ุงูุชุบููุฑุงุช** ูู ุงูููุงุญุธุงุช

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 4 ูุจุฑุงูุฑ 2026  
**ุงูุฅุตุฏุงุฑ:** 1.0
