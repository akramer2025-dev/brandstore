# ูุธุงู ูุฑุงูุจุฉ ูุดุงุท ุงูุดุฑูุงุก (Partner Activity Monitoring System)

## โ ุชู ุงูุชูููุฐ ุจูุฌุงุญ!

ุชู ุฅูุดุงุก ูุธุงู ุดุงูู ููุฑุงูุจุฉ ูุดุงุท ุฌููุน ุงูุดุฑูุงุก ุจุดูู ุฎูู (ุจุฏูู ุนูููู) ููุนุฑูุฉ ูู ูู ุงูุดุฑูู ุงููุดุท ููู ูู ุงููุชูุงุณู.

---

## ๐ฏ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. **ุงููุฑุงูุจุฉ ุงูุฎููุฉ (Stealth Monitoring)**
- ูุชู ุชุชุจุน ูุดุงุท ุงูุดุฑูุงุก ุชููุงุฆูุงู ุนูุฏ ูู ุชุณุฌูู ุฏุฎูู
- ุงูุดุฑูู ูุง ูุนูู ุฃูู ุชุญุช ุงููุฑุงูุจุฉ (ูุง ุชูุฌุฏ ุฃู ุฅุดุงุฑุงุช ูู ูุงุฌูุชู)
- ุฌููุน ุงูุจูุงูุงุช ุชูุฌูุน ูู ุงูุฎูููุฉ ุจุฏูู ุฃู ุชุฃุซูุฑ ุนูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

### 2. **ุงูุจูุงูุงุช ุงููุชุชุจุนุฉ**
ูุชู ุฌูุน ุงููุนูููุงุช ุงูุชุงููุฉ ููู ุดุฑูู:

#### **ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู:**
- ุนุฏุฏ ูุฑุงุช ุชุณุฌูู ุงูุฏุฎูู ุงูุฅุฌูุงููุฉ
- ุชุงุฑูุฎ ูููุช ุขุฎุฑ ุชุณุฌูู ุฏุฎูู
- ุชูุฑุงุฑ ุชุณุฌูู ุงูุฏุฎูู (ูู ุขุฎุฑ 7 ุฃูุงู)

#### **ูุนูููุงุช ุงูุฃุฌูุฒุฉ:**
- ููุน ุงูุฌูุงุฒ: ๐ฑ ููุจุงููุ ๐ป ูุงุจ ุชูุจ/ููุจููุชุฑุ ุฃู ๐ฑ ุชุงุจูุช
- ุนุฏุฏ ูุฑุงุช ุงูุฏุฎูู ูู ูู ููุน ุฌูุงุฒ
- ูููุฐุฌ ุงูุฌูุงุฒ (ุฅู ููุฌุฏ)

#### **ูุนูููุงุช ุงููุชุตูุญ:**
- ุงุณู ุงููุชุตูุญ (Chrome, Firefox, Safari, Edge, ุฅูุฎ)
- ุนุฏุฏ ูุฑุงุช ุงูุฏุฎูู ูู ูู ูุชุตูุญ
- ูุธุงู ุงูุชุดุบูู (Windows, MacOS, Android, iOS, ุฅูุฎ)

#### **ูุนูููุงุช ุงููููุน ุงูุฌุบุฑุงูู (ุชููุงุฆู):**
- ุงููุฏููุฉ ุงูุชู ุชู ุชุณุฌูู ุงูุฏุฎูู ูููุง
- ุงูุฏููุฉ
- ุนุฏุฏ ูุฑุงุช ุงูุฏุฎูู ูู ูู ูููุน
- ูุชู ุชุญุฏูุฏ ุงููููุน ูู ุนููุงู IP ุชููุงุฆูุงู ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ **ipapi.co**

### 3. **ุชุตููู ุงููุดุงุท (Activity Level)**
ูุชู ุชุตููู ูู ุดุฑูู ุญุณุจ ูุดุงุทู ูู ุขุฎุฑ 7 ุฃูุงู:

| ุงูุชุตููู | ุนุฏุฏ ูุฑุงุช ุชุณุฌูู ุงูุฏุฎูู | ุงูููู ูู ุงููุงุฌูุฉ |
|---------|----------------------|------------------|
| **ูุดุท ุฌุฏุงู** | โฅ10 ูุฑุงุช | ๐ข ุฃุฎุถุฑ |
| **ูุดุท** | โฅ5 ูุฑุงุช | ๐ต ุฃุฒุฑู |
| **ูุชูุณุท** | โฅ2 ูุฑุงุช | ๐ก ุฃุตูุฑ |
| **ุฎุงูู** | <2 ูุฑุงุช | ๐ด ุฃุญูุฑ |

---

## ๐ ููุญุฉ ุงููุฑุงูุจุฉ (Admin Dashboard)

### **ุงููุตูู:**
1. ุงุฐูุจ ุฅูู ููุญุฉ ุงูุฅุฏุงุฑุฉ ุงูุฑุฆูุณูุฉ: `/admin`
2. ุงุจุญุซ ุนู ุจุทุงูุฉ **"๐ ูุดุงุท ุงูุดุฑูุงุก"**
3. ุฃู ุงุฐูุจ ูุจุงุดุฑุฉ ุฅูู: `/admin/partners/activity`

### **ุงููุงุฌูุฉ:**

#### **ุจุทุงูุงุช ุงูููุฎุต (Summary Cards):**
- **ุฅุฌูุงูู ุงูุดุฑูุงุก**: ุงูุนุฏุฏ ุงูููู
- **ูุดุท ุฌุฏุงู**: ุนุฏุฏ ุงูุดุฑูุงุก ุงููุดุทูู ุจุดูู ูุจูุฑ
- **ูุดุท**: ุนุฏุฏ ุงูุดุฑูุงุก ุงููุดุทูู
- **ูุชูุณุท**: ุนุฏุฏ ุงูุดุฑูุงุก ูุชูุณุทู ุงููุดุงุท
- **ุฎุงูู**: ุนุฏุฏ ุงูุดุฑูุงุก ุงูุฎุงูููู

๐ก **ููููู ุงูุถุบุท ุนูู ุฃู ุจุทุงูุฉ ููุฎุต ููุชุตููุฉ ุญุณุจ ูุณุชูู ุงููุดุงุท!**

#### **ุจุทุงูุงุช ุงูุดุฑูุงุก (Partner Cards):**
ูู ุดุฑูู ูู ุจุทุงูุฉ ุชุญุชูู ุนูู:

1. **ุงุณู ุงูุดุฑูู** + **ุดุงุฑุฉ ูุณุชูู ุงููุดุงุท** (ููููุฉ)
2. **ุฅุฌูุงูู ุชุณุฌููุงุช ุงูุฏุฎูู**
3. **ุขุฎุฑ ุชุณุฌูู ุฏุฎูู** (ูุน ุนุฑุถ ุงูููุช ุจุงูุนุฑุจูุฉ: "ููุฐ X ุฏูููุฉ/ุณุงุนุฉ/ููู")
4. **ุงูุฃุฌูุฒุฉ ุงููุณุชุฎุฏูุฉ:**
   - ๐ฑ ููุจุงูู: X ูุฑุงุช
   - ๐ป ููุจููุชุฑ: X ูุฑุงุช
   - ๐ฑ ุชุงุจูุช: X ูุฑุงุช
5. **ุงููุชุตูุญุงุช ุงููุณุชุฎุฏูุฉ:**
   - Chrome: X ูุฑุงุช
   - Firefox: X ูุฑุงุช
   - ุฅูุฎ...
6. **ุงูููุงูุน ุงูุฌุบุฑุงููุฉ:**
   - ๐ ุงููุงูุฑุฉ, ูุตุฑ: X ูุฑุงุช
   - ๐ ุงูุฅุณููุฏุฑูุฉ, ูุตุฑ: X ูุฑุงุช
   - ุฅูุฎ...
7. **ุขุฎุฑ ุงููุดุงุทุงุช (ูุงุจูุฉ ููุชูุณูุน):**
   - ุนุฑุถ ุขุฎุฑ 10 ูุดุงุทุงุช
   - ูููู ุชูุณูุน ูู ูุดุงุท ูุฑุคูุฉ ุงูุชูุงุตูู ุงููุงููุฉ:
     - ููุน ุงูุฌูุงุฒ
     - ุงููุชุตูุญ
     - ูุธุงู ุงูุชุดุบูู
     - ุงููููุน
     - IP Address
     - User Agent (ุงูุชูุงุตูู ุงูุชูููุฉ)

---

## ๐ง ุงูุชูุงุตูู ุงูุชูููุฉ

### **ูุงุนุฏุฉ ุงูุจูุงูุงุช:**
- ูุชู ุงุณุชุฎุฏุงู ุงูููุฏูู ุงูููุฌูุฏ ุจุงููุนู: `UserActivityLog`
- **ูุง ุญุงุฌุฉ ูุฃู Migration!** ุฌููุน ุงูุญููู ุงููุทููุจุฉ ููุฌูุฏุฉ ุจุงููุนู

### **ุงููููุงุช ุงููููุดุฃุฉ/ุงูููุนุฏููุฉ:**

#### **1. ูููุงุช ุฌุฏูุฏุฉ:**
- `src/app/admin/partners/activity/page.tsx` - ุตูุญุฉ ููุญุฉ ุงููุฑุงูุจุฉ
- `src/app/api/admin/partners/activity/route.ts` - API ููุญุตูู ุนูู ุงูุฅุญุตุงุฆูุงุช

#### **2. ูููุงุช ููุนุฏููุฉ:**
- `src/lib/user-activity.ts` - ุฅุถุงูุฉ ูุธููุฉ `getAllPartnersActivityStats()` ูุชุญุณูู `logUserActivity()` ุจุฅุถุงูุฉ ุชุชุจุน ุงููููุน ุงูุฌุบุฑุงูู
- `src/app/admin/page.tsx` - ุฅุถุงูุฉ ุจุทุงูุฉ "ูุดุงุท ุงูุดุฑูุงุก" ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ

### **ุฎุฏูุงุช ุฎุงุฑุฌูุฉ:**
- **ipapi.co**: ุฎุฏูุฉ ูุฌุงููุฉ ูุชุญุฏูุฏ ุงููููุน ูู IP
  - ุงูุญุฏ ุงูุฃูุตู: **30,000 ุทูุจ/ุดูุฑ**
  - ูุชู ุงูุงุญุชูุงุธ ุจุงูุจูุงูุงุช ููุฏุฉ ุณุงุนุฉ ูุงุญุฏุฉ (caching) ูุชูููู ุงูุทูุจุงุช
  - ูู ุญุงูุฉ ูุดู ุงูุฎุฏูุฉุ ูุชู ุชุณุฌูู "Unknown, Unknown" ุจุฏูู ุฃุฎุทุงุก

### **ุงูุฃูุงู:**
- ุงููุตูู ูุญุตูุฑ ุนูู **ADMIN** ููุท
- ูุชู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูู API
- ูุง ูููู ููุดุฑูุงุก ุฑุคูุฉ ูุดุงุทูู ุฃู ูุดุงุท ุบูุฑูู

---

## ๐ ููู ูุนูู ุงููุธุงูุ

### **1. ุงูุชุชุจุน ุงูุชููุงุฆู:**
ุนูุฏ ุชุณุฌูู ุฏุฎูู ุฃู ุดุฑูู:
```typescript
// ูู src/lib/auth.ts (ููุฌูุฏ ุจุงููุนู)
await logUserActivity(user.id, 'LOGIN');
```

ูุชู ุชููุงุฆูุงู:
- ุงุณุชุฎุฑุงุฌ ูุนูููุงุช ุงูุฌูุงุฒ ูู User Agent
- ุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู ูู IP
- ุญูุธ ุฌููุน ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **2. ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช:**
ุนูุฏ ูุชุญ ููุญุฉ ุงููุฑุงูุจุฉ:
```typescript
// ูู src/lib/user-activity.ts
const stats = await getAllPartnersActivityStats();
```

ูุชู ุชููุงุฆูุงู:
- ุฌูุจ ุฌููุน ุงูุดุฑูุงุก
- ุชุญููู ุขุฎุฑ 100 ูุดุงุท ููู ุดุฑูู
- ุญุณุงุจ ุนุฏุฏ ุชุณุฌููุงุช ุงูุฏุฎูู ูู ุขุฎุฑ 7 ุฃูุงู
- ุชุญุฏูุฏ ูุณุชูู ุงููุดุงุท
- ุฌูุน ุฅุญุตุงุฆูุงุช ุงูุฃุฌูุฒุฉ ูุงููุชุตูุญุงุช ูุงูููุงูุน

### **3. ุงูุนุฑุถ ูู ุงููุงุฌูุฉ:**
- ุชุฑุชูุจ ุงูุดุฑูุงุก ุญุณุจ ูุณุชูู ุงููุดุงุท (ุงูุฃูุซุฑ ูุดุงุทุงู ุฃููุงู)
- ุชูููู ุงูุจุทุงูุงุช ุญุณุจ ูุณุชูู ุงููุดุงุท
- ุฅููุงููุฉ ุงูุชุตููุฉ ุจุถุบุทุฉ ูุงุญุฏุฉ

---

## ๐ ุงูุงุณุชุฎุฏุงู ุงูุนููู

### **ุณููุงุฑูู 1: ูุนุฑูุฉ ุงูุดุฑูุงุก ุงููุดุทูู**
1. ุงูุชุญ `/admin/partners/activity`
2. ุงูุธุฑ ุฅูู ุจุทุงูุฉ "ูุดุท ุฌุฏุงู" ูู ุงูุฃุนูู
3. ุงุถุบุท ุนูููุง ูุฑุคูุฉ ููุท ุงูุดุฑูุงุก ุงููุดุทูู ุฌุฏุงู

### **ุณููุงุฑูู 2: ูุชุงุจุนุฉ ุดุฑูู ูุนูู**
1. ุงุจุญุซ ุนู ุงุณู ุงูุดุฑูู ูู ุงููุงุฆูุฉ
2. ุงุถุบุท ุนูู "ุนุฑุถ ุขุฎุฑ ุงููุดุงุทุงุช" ูู ุจุทุงูุชู
3. ุชุงุจุน ุชูุงุตูู ูุดุงุทู ุจุงููุงูู

### **ุณููุงุฑูู 3: ูุนุฑูุฉ ุงูุดุฑูุงุก ุงูุฎุงูููู**
1. ุงุถุบุท ุนูู ุจุทุงูุฉ "ุฎุงูู" ูู ุงูุฃุนูู
2. ุชุธูุฑ ูู ูุงุฆูุฉ ุจุงูุดุฑูุงุก ุงูุฐูู ูู ูุณุฌููุง ุฏุฎูู ูุซูุฑุงู
3. ููููู ุงูุชูุงุตู ูุนูู ุฃู ุงุชุฎุงุฐ ูุฑุงุฑ ุจุดุฃููู

---

## ๐ก ูุตุงุฆุญ ูููุฉ

### **โ ุงูุนู:**
- ุฑุงุฌุน ุงููุดุงุท ุฃุณุจูุนูุงู ููุชุงุจุนุฉ ุงูุดุฑูุงุก
- ุงุณุชุฎุฏู ุงูุชุตููุฉ ุญุณุจ ูุณุชูู ุงููุดุงุท ููุชุฑููุฒ
- ุชุงุจุน ุงูุดุฑูุงุก ุงูุฎุงูููู ููุนุฑูุฉ ุณุจุจ ุนุฏู ูุดุงุทูู

### **โ ูุง ุชูุนู:**
- ูุง ุชุฎุจุฑ ุงูุดุฑูุงุก ุนู ูุฐุง ุงููุธุงู (ุฎูู)
- ูุง ุชุนุชูุฏ ููุท ุนูู ุนุฏุฏ ุชุณุฌููุงุช ุงูุฏุฎูู ููููุงุณ ูุญูุฏ ููุฃุฏุงุก
- ูุง ุชุณุชุฎุฏู ุงูุจูุงูุงุช ุจุดูู ุณูุจู ุถุฏ ุงูุดุฑูุงุก

---

## ๐ ุฃูุซูุฉ ุนูู ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ

### **ูุซุงู: ุดุฑูู ูุดุท ุฌุฏุงู**
```
ูุดุท ุฌุฏุงู ๐ข

ุฃุญูุฏ ูุญูุฏ
ุฅุฌูุงูู ุชุณุฌููุงุช ุงูุฏุฎูู: 45
ุขุฎุฑ ุชุณุฌูู ุฏุฎูู: ููุฐ 5 ุฏูุงุฆู

ุงูุฃุฌูุฒุฉ:
๐ฑ ููุจุงูู: 30 ูุฑุฉ
๐ป ููุจููุชุฑ: 15 ูุฑุฉ

ุงููุชุตูุญุงุช:
Chrome: 40 ูุฑุฉ
Safari: 5 ูุฑุงุช

ุงูููุงูุน:
๐ ุงููุงูุฑุฉ, ูุตุฑ: 35 ูุฑุฉ
๐ ุงูุฅุณููุฏุฑูุฉ, ูุตุฑ: 10 ูุฑุงุช
```

### **ูุซุงู: ุดุฑูู ุฎุงูู**
```
ุฎุงูู ๐ด

ูุญูุฏ ุฃุญูุฏ
ุฅุฌูุงูู ุชุณุฌููุงุช ุงูุฏุฎูู: 2
ุขุฎุฑ ุชุณุฌูู ุฏุฎูู: ููุฐ 5 ุฃูุงู

ุงูุฃุฌูุฒุฉ:
๐ฑ ููุจุงูู: 2 ูุฑุฉ

ุงููุชุตูุญุงุช:
Chrome: 2 ูุฑุฉ

ุงูููุงูุน:
๐ ุงูุฌูุฒุฉ, ูุตุฑ: 2 ูุฑุฉ
```

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ูุงูุตูุงูุฉ

### **ุญุฏ ุงูุทูุจุงุช (Rate Limit):**
- ุงูุฎุฏูุฉ ุงููุฌุงููุฉ ipapi.co ุชุณูุญ ุจู **30,000 ุทูุจ/ุดูุฑ**
- ุฅุฐุง ูุงู ูุฏูู ุฃูุซุฑ ูู 1000 ุดุฑูู ูุณุฌููู ุฏุฎูู ููููุงูุ ูุฏ ุชุญุชุงุฌ ุฎุทุฉ ูุฏููุนุฉ
- ูุชู cache ุงูุจูุงูุงุช ููุฏุฉ ุณุงุนุฉ ูุชูููู ุงูุทูุจุงุช

### **ุชูุธูู ุงูุจูุงูุงุช ุงููุฏููุฉ:**
ููุฌุฏ ุจุงููุนู ูู `user-activity.ts` ุฏุงูุฉ `cleanOldActivityLogs()` ูุญุฐู ุงูุณุฌูุงุช ุงูุฃูุฏู ูู 90 ููู.

ููููู ุชุดุบูููุง ูุฏููุงู ุฃู ุฌุฏููุชูุง:
```typescript
await cleanOldActivityLogs();
```

---

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุชุญูู ูู ุฃู ุงูุตูุงุญูุฉ ูู ADMIN ูู ุญุณุงุจู
2. ุชุฃูุฏ ูู ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุตูุฉ
3. ุชุญูู ูู console ุงููุชุตูุญ ููุฃุฎุทุงุก
4. ุฑุงุฌุน ุงููููุงุช ุงููุนุฏูุฉ ูู commit `6692d16`

---

## ๐ ููุฎุต ุงููููุฒุงุช

โ **ูุฑุงูุจุฉ ุฎููุฉ** - ุงูุดุฑูุงุก ูุง ูุนูููู  
โ **ุจูุงูุงุช ุดุงููุฉ** - ุฃุฌูุฒุฉุ ููุงูุนุ ูุชุตูุญุงุช  
โ **ุชุตููู ุฐูู** - ูุดุท ุฌุฏุงู โ ุฎุงูู  
โ **ูุงุฌูุฉ ุณููุฉ** - ุชุตููุฉ ุจุถุบุทุฉ ูุงุญุฏุฉ  
โ **ุชูุงุตูู ูุงููุฉ** - ุชุงุฑูุฎ ูุงูู ููู ูุดุงุท  
โ **ุฃูุงู ุนุงูู** - ADMIN ููุท  
โ **ูุฌุงูู ุชูุงูุงู** - ุญุชู 30k ุทูุจ/ุดูุฑ  

---

**ุชู ุจูุฌุงุญ! ๐**

ุงูุขู ููููู ูุนุฑูุฉ ูู ูู ุงูุดุฑูู ุงููุดุท ููู ูู ุงููุชูุงุณู ุจูู ุณูููุฉ!
