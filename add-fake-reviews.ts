import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// ุฃุณูุงุก ุนุฑุจูุฉ ููููุฉ
const arabicNames = [
  'ูุญูุฏ ุฃุญูุฏ', 'ูุงุทูุฉ ูุญููุฏ', 'ุฃุญูุฏ ุนูู', 'ุณุงุฑุฉ ุฎุงูุฏ', 'ุนูุฑ ุญุณู',
  'ูุฑูู ุนุจุฏุงููู', 'ุฎุงูุฏ ููุณู', 'ููุฑ ุงูุฏูู', 'ูููู ุฅุจุฑุงููู', 'ููุณู ูุญูุฏ',
  'ูุฏู ุนุจุฏุงูุฑุญูู', 'ูุฑูู ุณุนูุฏ', 'ุฑูุง ุญุณูู', 'ุทุงุฑู ุนุงุฏู', 'ุฏููุง ุฃุญูุฏ',
  'ูููุฏ ูุญูุฏ', 'ูุงุณููู ุนูู', 'ุญุณุงู ุงูุฏูู', 'ููู ูุชุญู', 'ุนุงุฏู ุตูุงุญ',
  'ููู ูุญููุฏ', 'ุณุงูู ุญุณู', 'ุฅููุงู ุฎุงูุฏ', 'ุจุงุณู ููุณู', 'ุดููุงุก ุฃุญูุฏ',
  'ุฃููุฑ ุนุจุฏุงููู', 'ูุงุฏูุฉ ุนูู', 'ุชุงูุฑ ูุญูุฏ', 'ุฑูู ุญุณูู', 'ูุงุฆู ุฅุจุฑุงููู',
  'ุณููู ุฎุงูุฏ', 'ูุตุทูู ุฃุญูุฏ', 'ูุจุฉ ูุญููุฏ', 'ุนุจุฏุงูุฑุญูู ุนูู', 'ุฏุงููุง ุญุณู',
  'ุฌูุงู ูุญูุฏ', 'ูููุง ููุณู', 'ูุงุฌุฏ ุฎุงูุฏ', 'ุฑูุงู ุฃุญูุฏ', 'ูุงุฏู ุนุจุฏุงููู'
];

// ุชุนูููุงุช ุฅูุฌุงุจูุฉ ูุชููุนุฉ
const positiveComments = [
  // ุนู ุงูุฌูุฏุฉ
  'ุงูููุชุฌ ููุชุงุฒ ุฌุฏุงู ูุงูุฌูุฏุฉ ุนุงููุฉุ ูููุน ูุฏูุฉ ููุงู!',
  'ุฌูุฏุฉ ุฎุงูุฉ ุฑุงุฆุนุฉ ูุชูุตูู ูุญุชุฑูุ ุฃูุตุญ ุจุงูุดุฑุงุก ุจุฏูู ุชุฑุฏุฏ',
  'ูุงุดุงุก ุงููู ุงูุฎุงูุฉ ูุงุฎุฑุฉ ูุงูุชูุตูู ุฏููู ุฌุฏุงู',
  'ุงูููุชุฌ ุฌููู ุฌุฏุงู ูุฌูุฏุฉ ุนุงููุฉุ ูุณุชุงูู ูู ูุฑุด ููู',
  'ููุชุงุฒ ูุงูุฎุงูุฉ ููุชุงุฒุฉุ ุญุงุทูุจ ุชุงูู ุจุฅุฐู ุงููู',
  
  // ุนู ุงูููุงุณ ูุงูููุงุณุจุฉ
  'ุงูููุงุณ ูุธุจูุท 100% ูุงูุฎุงูุฉ ูุงุนูุฉ ุฌุฏุงู',
  'ููุงุณุจ ุฌุฏุงู ููุฑูุญ ูู ุงููุจุณุ ุงูุฃููุงู ุฒู ุงูุตูุฑุฉ ุจุงูุธุจุท',
  'ุงูููุชุฌ ุฃุญูู ูู ุงูุตูุฑ ูุงูููุงุณ ูุธุจูุท ุนูู ุงูุขุฎุฑ',
  'ุชูุงู ุงูุชูุงู! ุงูููุงุณ ูุถุจูุท ูุงูุฎุงูุฉ ูุงุนูุฉ ููุฑูุญุฉ',
  
  // ุนู ุงูุณุนุฑ ูุงููููุฉ
  'ุณุนุฑู ููุชุงุฒ ููุงุฑูุฉ ุจุงูุฌูุฏุฉุ ุตููุฉ ุฑุงุจุญุฉ',
  'ุงููููุฉ ููุงุจู ุงูุณุนุฑ ููุชุงุฒุฉ ุฌุฏุงูุ ูุณุชุญู ุงูุดุฑุงุก',
  'ุงูุณุนุฑ ุญูู ูุงูุฌูุฏุฉ ุฃุญููุ ูุนููู ุฌุฏุงู',
  'ุจุฌุฏ ุณุนุฑ ูููุณ ูุงูููุชุฌ ูุณุชุงูู ุฃูุชุฑ ูู ูุฏู',
  
  // ุนู ุงูุชูุตูู
  'ุงูุชูุตูู ูุงู ุณุฑูุน ุฌุฏุงู ูุงูููุชุฌ ูุตู ูู ุญุงูุฉ ููุชุงุฒุฉ',
  'ูุตู ุจุณุฑุนุฉ ุงูุจุฑู ูุงูุชุบููู ูุญุชุฑู ุฌุฏุงู',
  'ุงูุชูุตูู ุฃุณุฑุน ูู ุงููุชููุน ูุงูููุชุฌ ุณููู 100%',
  'ุฎุฏูุฉ ุงูุชูุตูู ููุชุงุฒุฉ ูุงูุทูุจ ูุตู ูู ุฃูู ูู ููููู',
  'ุงูุชูุตูู ุณุฑูุน ูุงูููุตู ูุญุชุฑู ุฌุฏุงูุ ุดูุฑุงู ูููู',
  
  // ุนู ุงูุฎุฏูุฉ ูุงูุชุนุงูู
  'ุงูุชุนุงูู ุฑุงูู ุฌุฏุงู ูุฎุฏูุฉ ุนููุงุก ููุชุงุฒุฉ',
  'ุงูุจุงุฆุน ูุญุชุฑู ุฌุฏุงู ูุณูู ุงูุชุนุงูู ูุนุงู',
  'ุฎุฏูุฉ ุงูุนููุงุก ุฑุงุฆุนุฉ ูุฑุฏูุง ุนูู ุงุณุชูุณุงุฑุงุชู ุจุณุฑุนุฉ',
  'ุชุนุงูู ูุญุชุฑู ุฌุฏุงู ูู ุงูุจุฏุงูุฉ ููููุงูุฉ',
  
  // ุดุงููุฉ
  'ุงูููุชุฌ ููุชุงุฒ ูุงูุชูุตูู ุณุฑูุน ูุงูุฎุฏูุฉ ูุญุชุฑูุฉุ 5 ูุฌูู',
  'ูู ุญุงุฌุฉ ุชูุงู! ุงูููุชุฌ ูุงูุชูุตูู ูุงูุชุนุงูู ููู ููุชุงุฒ',
  'ุชุฌุฑุจุฉ ุฑุงุฆุนุฉ ูู ุงูุทูุจ ููุชูุตููุ ุดูุฑุงู ุฌุฏุงู',
  'ุฑุงุถู ุฌุฏุงู ุนู ุงูููุชุฌ ูุงูุฎุฏูุฉุ ุญุงุทูุจ ุชุงูู ุฃููุฏ',
  'ูุงุดุงุก ุงููู ุชุจุงุฑู ุงูููุ ุงูููุชุฌ ูุงูุฎุฏูุฉ ูู ุงูููุฉ',
  
  // ูููุฒุฉ
  'ุงูููุชุฌ ูุงู ุชููุนุงุชู ุจูุชูุฑ! ุฌูุฏุฉ ูุฎุงูุฉ ูุชูุตูู ุณุฑูุน',
  'ุฃุญุณู ุดุฑุงุก ุนููุชู ุงูุณูุฉ ุฏู! ุงูููุชุฌ ุชุญูุฉ ุจุฌุฏ',
  'ูู ุฃูุถู ุงููุชุงุฌุฑ ุงููู ุชุนุงููุช ูุนุงูุงุ ูู ุญุงุฌุฉ ูุธุจูุทุฉ',
  'ุงูุตุฑุงุญุฉ ููู ุงูููุชุงุฒ! ุงูููุชุฌ ูุงูุชุนุงูู ูุงูุฎุฏูุฉ ูููุง 10/10',
  'ุชุฌุฑุจุฉ ุชุณูู ุฑุงุฆุนุฉุ ุงูููุชุฌ ุฃุฌูู ูู ุงูุตูุฑ ููุงู',
  
  // ูุน ุชูุตูุงุช
  'ููุชุงุฒ ุฌุฏุงู! ุฑุดุญุชู ููู ุตุญุงุจู ูุนุงุฆูุชู',
  'ููุชุฌ ุฑููุจ! ูุตุญุช ูู ุงููุงุณ ุงููู ุฃุนุฑููู ูุทูุจูุง ูููู',
  'ุฃููุฏ ุญุงุฑุฌุน ุฃุทูุจ ุชุงููุ ุงูููุชุฌ ูุงูุฎุฏูุฉ ููุชุงุฒูู',
  'ุชุฌุฑุจุฉ ูุงุฌุญุฉ ุจูู ุงูููุงููุณ! ุดูุฑุงู ูุฅูู ุงูุฃูุงู',
  'ุฑุจูุง ูุจุงุฑู ูู ุดุบูููุ ุงูููุชุฌ ูุงูุชุนุงูู ูู ุงูููุฉ'
];

// ุฏุงูุฉ ูุงุฎุชูุงุฑ ุนูุตุฑ ุนุดูุงุฆู ูู ูุตูููุฉ
function getRandomItem<T>(array: T[]): T {
  return array[Math.floor(Math.random() * array.length)];
}

// ุฏุงูุฉ ูุชูููุฏ ุชูููู ุนุดูุงุฆู (4 ุฃู 5 ูุฌูู ูู ุงูุบุงูุจ)
function getRandomRating(): number {
  const rand = Math.random();
  if (rand < 0.7) return 5; // 70% ุฎูุณ ูุฌูู
  if (rand < 0.95) return 4; // 25% ุฃุฑุจุน ูุฌูู
  return 3; // 5% ุซูุงุซ ูุฌูู
}

// ุฏุงูุฉ ูุชูููุฏ ุชุงุฑูุฎ ุนุดูุงุฆู ูู ุขุฎุฑ 3 ุดููุฑ
function getRandomDate(): Date {
  const now = new Date();
  const threeMonthsAgo = new Date(now.getTime() - 90 * 24 * 60 * 60 * 1000);
  const randomTime = threeMonthsAgo.getTime() + Math.random() * (now.getTime() - threeMonthsAgo.getTime());
  return new Date(randomTime);
}

async function addFakeReviews() {
  console.log('๐ญ ุฌุงุฑู ุฅุถุงูุฉ ุงูุชููููุงุช ุงูููููุฉ...\n');

  try {
    // ุฌูุจ ุฌููุน ุงูููุชุฌุงุช
    const products = await prisma.product.findMany({
      select: {
        id: true,
        nameAr: true,
      },
    });

    if (products.length === 0) {
      console.log('โ ูุง ุชูุฌุฏ ููุชุฌุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช');
      return;
    }

    console.log(`๐ฆ ุชู ุงูุนุซูุฑ ุนูู ${products.length} ููุชุฌ\n`);

    let totalReviewsAdded = 0;
    const usedNames = new Set<string>();

    // ุฅุถุงูุฉ ุชููููุงุช ููู ููุชุฌ
    for (const product of products) {
      // ุนุฏุฏ ุงูุชููููุงุช ููู ููุชุฌ (ูู 3 ุฅูู 8 ุชููููุงุช)
      const numReviews = Math.floor(Math.random() * 6) + 3;
      
      console.log(`๐ ุฅุถุงูุฉ ${numReviews} ุชูููู ููููุชุฌ: ${product.nameAr}`);

      for (let i = 0; i < numReviews; i++) {
        // ุงุฎุชูุงุฑ ุงุณู ูู ููุณุชุฎุฏู ุจุนุฏ ููุฐุง ุงูููุชุฌ
        let reviewerName: string;
        do {
          reviewerName = getRandomItem(arabicNames);
        } while (usedNames.has(`${product.id}-${reviewerName}`));
        
        usedNames.add(`${product.id}-${reviewerName}`);

        const rating = getRandomRating();
        const comment = getRandomItem(positiveComments);
        const createdAt = getRandomDate();

        try {
          // ุฅูุดุงุก ูุณุชุฎุฏู ูููู (ุจุฑูุฏ ุฅููุชุฑููู ูููู)
          const fakeEmail = `fake_${reviewerName.replace(/\s+/g, '_').toLowerCase()}_${Date.now()}_${Math.random().toString(36).substring(7)}@fake.local`;
          
          let user = await prisma.user.findUnique({
            where: { email: fakeEmail },
          });

          if (!user) {
            user = await prisma.user.create({
              data: {
                email: fakeEmail,
                name: reviewerName,
                role: 'CUSTOMER',
              },
            });
          }

          // ุฅุถุงูุฉ ุงูุชูููู
          await prisma.review.create({
            data: {
              productId: product.id,
              userId: user.id,
              rating: rating,
              comment: comment,
              createdAt: createdAt,
              updatedAt: createdAt,
            },
          });

          console.log(`   โ ${reviewerName}: ${rating}โญ - "${comment.substring(0, 40)}..."`);
          totalReviewsAdded++;
        } catch (error) {
          console.error(`   โ ุฎุทุฃ ูู ุฅุถุงูุฉ ุชูููู: ${(error as Error).message}`);
        }
      }

      console.log('');
    }

    console.log(`\nโ ุชู ุฅุถุงูุฉ ${totalReviewsAdded} ุชูููู ุจูุฌุงุญ!`);
    console.log('๐ ุงูุชููุช ุนูููุฉ ุฅุถุงูุฉ ุงูุชููููุงุช ุงูููููุฉ!\n');

  } catch (error) {
    console.error('โ ุฎุทุฃ:', error);
    throw error;
  } finally {
    await prisma.$disconnect();
  }
}

addFakeReviews()
  .catch((error) => {
    console.error('โ ูุดูุช ุงูุนูููุฉ:', error);
    process.exit(1);
  });
