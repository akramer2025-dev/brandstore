# ุฏููู ุฅุถุงูุฉ ููุธูู ุงูุดุฑูุงุก - Partner Staff Management Guide

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุถุงูุฉ ูุธุงู ุฌุฏูุฏ ูุฅุฏุงุฑุฉ ููุธูู ุงูุดุฑูุงุกุ ุญูุซ ูููู ูููุฏูุฑ ุฅุถุงูุฉ ููุธููู ููู ุดุฑูู ูุน ุชุญุฏูุฏ ุงูุตูุงุญูุงุช ุงูุฎุงุตุฉ ุจูู.

## ๐ฏ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ุฏูุฑ ุฌุฏูุฏ ูู ุงููุธุงู: PARTNER_STAFF
- ููุธู ูุฑุชุจุท ุจุดุฑูู ูุญุฏุฏ
- ูุฏูู ุตูุงุญูุงุช ูุญุฏุฏุฉ ูุชู ุชุฎุตูุตูุง ุนูุฏ ุงูุฅูุดุงุก
- ููููู ุงููุตูู ุฅูู ุจูุงูุงุช ุงูุดุฑูู ููุท

### 2. ุตูุงุญูุงุช ูุงุจูุฉ ููุชุฎุตูุต
ูููู ุชุญุฏูุฏ ุงูุตูุงุญูุงุช ุงูุชุงููุฉ ููู ููุธู:
- โ **ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช**: ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐู ุงูููุชุฌุงุช
- โ **ุฅุฏุงุฑุฉ ุงูุทูุจุงุช**: ูุนุงูุฌุฉ ุงูุทูุจุงุช ูุชุญุฏูุซ ุญุงูุชูุง
- โ **ุนุฑุถ ุงูุชูุงุฑูุฑ**: ุงููุตูู ุฅูู ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช
- โ **ุฅุฏุงุฑุฉ ุงููุฎุฒูู**: ุงูุชุญูู ูู ุงููุฎุฒูู ูุงูููุงุฏ

---

## ๐ ุฎุทูุงุช ุงูุชุฌุฑุจุฉ

### ุงูุฎุทูุฉ 1: ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
ูุจู ุงูุจุฏุกุ ูุฌุจ ุชุญุฏูุซ schema ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```bash
# ูู terminal PowerShell
npm run prisma:generate
npm run prisma:migrate dev --name add-partner-staff
```

ุฃู ุฅุฐุง ููุช ุชุณุชุฎุฏู ูุงุนุฏุฉ ุจูุงูุงุช Production:

```bash
npx prisma db push
```

---

### ุงูุฎุทูุฉ 2: ุงููุตูู ุฅูู ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุดุฑูุงุก

1. ุณุฌู ุฏุฎูู ููุฏูุฑ (ADMIN)
2. ุงูุชูู ุฅูู **ููุญุฉ ุงูุฅุฏุงุฑุฉ** โ **ุฅุฏุงุฑุฉ ุงูุดุฑูุงุก**
3. ุงููุณุงุฑ: `http://localhost:3000/admin/partners`

ุฃู ูุจุงุดุฑุฉ ูู ูุงุฆูุฉ ุงูุฅุฏุงุฑุฉ ุงูุฑุฆูุณูุฉ ูู:
```
http://localhost:3000/admin
```

---

### ุงูุฎุทูุฉ 3: ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ

#### ุฃ. ุงุฎุชุฑ ุงูุดุฑูู
- ูู ุตูุญุฉ ุงูุดุฑูุงุกุ ุณุชุฌุฏ ูุงุฆูุฉ ุจุฌููุน ุงูุดุฑูุงุก
- ูู ุจุทุงูุฉ ุดุฑูู ุชุญุชูู ุนูู ุฃุฒุฑุงุฑ ุนูู ุงูุฌุงูุจ ุงูุฃูุณุฑ

#### ุจ. ุงุถุบุท ุนูู ุฒุฑ "ุฅุถุงูุฉ ููุธู"
- ุงูุฒุฑ ุจุงูููู ุงูุฃุฎุถุฑ ๐ข ูุน ุฃููููุฉ `UserPlus`
- ููุฌูุฏ ุจูู ุฒุฑ "ุงูุชูุงุตูู" ูุฒุฑ "ุชุนุฏูู"

#### ุฌ. ุงููุฃ ุจูุงูุงุช ุงูููุธู
ุณูุธูุฑ ูููุฐุฌ ูุญุชูู ุนูู:

1. **ุงุณู ุงูููุธู*** (ูุทููุจ)
   - ูุซุงู: `ุฃุญูุฏ ูุญูุฏ`

2. **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (Gmail)*** (ูุทููุจ)
   - ูุซุงู: `ahmed.staff@gmail.com`
   - ูุฌุจ ุฃู ูููู ุจุฑูุฏ ูุฑูุฏ ุบูุฑ ูุณุชุฎุฏู

3. **ูููุฉ ุงููุฑูุฑ*** (ูุทููุจุฉ)
   - ูุซุงู: `StaffPass123!`
   - โ๏ธ **ููู**: ุณูุชู ุนุฑุถ ูููุฉ ุงููุฑูุฑ ูุฑุฉ ูุงุญุฏุฉ ููุทุ ุงุญูุธูุง!

4. **ุฑูู ุงููุงุชู** (ุงุฎุชูุงุฑู)
   - ูุซุงู: `01234567890`

5. **ุงูุตูุงุญูุงุช** (ูููู ุชุญุฏูุฏ ุฃูุซุฑ ูู ูุงุญุฏุฉ):
   - โ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช (ูุญุฏุฏุฉ ุงูุชุฑุงุถูุงู)
   - โ ุฅุฏุงุฑุฉ ุงูุทูุจุงุช (ูุญุฏุฏุฉ ุงูุชุฑุงุถูุงู)
   - โ ุนุฑุถ ุงูุชูุงุฑูุฑ (ูุญุฏุฏุฉ ุงูุชุฑุงุถูุงู)
   - โฌ ุฅุฏุงุฑุฉ ุงููุฎุฒูู

#### ุฏ. ุงุถุบุท "ุฅุถุงูุฉ ุงูููุธู"
- ุณูุชู ุฅูุดุงุก ุงูุญุณุงุจ ููุฑุงู
- ุณุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ ุชุญุชูู ุนูู ุจูุงูุงุช ุงูุฏุฎูู
- **ุงุญูุธ ุจูุงูุงุช ุงูุฏุฎูู ูู ููุงู ุขูู!**

---

### ุงูุฎุทูุฉ 4: ุงูุชุญูู ูู ุฅูุดุงุก ุงูููุธู

#### ูู Console
ุณุชุฌุฏ ุฑุณุงูุฉ ูู console ุงููุชุตูุญ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุชู ุฅูุดุงุก ุญุณุงุจ ููุธู ุดุฑูู ุฌุฏูุฏ:
   ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ
   ุงูุจุฑูุฏ: ahmed.staff@gmail.com
   ูููุฉ ุงููุฑูุฑ: StaffPass123!
   ุงูุดุฑูู: ูุญูุฏ ุนูู
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
ููููู ุงูุชุญูู ูู ุฎูุงู Prisma Studio:
```bash
npx prisma studio
```

ุชุญูู ูู:
- ุฌุฏูู `users`: ุณุชุฌุฏ ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ ุจู role = `PARTNER_STAFF`
- ุญูู `partnerId`: ุณูููู ูุนุจุฃ ุจูุนุฑู ุงูุดุฑูู
- ุญูู `partnerStaffPermissions`: ูุญุชูู ุนูู ุงูุตูุงุญูุงุช ูู JSON

---

## ๐งช ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู ูููุธู

### 1. ุชุณุฌูู ุงูุฎุฑูุฌ ูู ุญุณุงุจ ุงููุฏูุฑ
```
http://localhost:3000/api/auth/signout
```

### 2. ุชุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ ุงูููุธู
```
http://localhost:3000/auth/login
```

ุงุณุชุฎุฏู:
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: `ahmed.staff@gmail.com`
- ูููุฉ ุงููุฑูุฑ: `StaffPass123!`

### 3. ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- ุณูุชู ุชูุฌููู ุฅูู ููุญุฉ ุชุญูู ุฎุงุตุฉ ุจุงูููุธู
- ุณุชุธูุฑ ููุท ุงูุฃูุณุงู ุงููุณููุญ ุจูุง ุญุณุจ ุงูุตูุงุญูุงุช
- ูู ูุชููู ูู ุงููุตูู ุฅูู ุฅุนุฏุงุฏุงุช ุงูุดุฑูุงุก ุฃู ุงููุฏูุฑ

---

## ๐ ุนุฑุถ ููุธูู ุงูุดุฑูู

### ุงุณุชุฎุฏุงู API ูุจุงุดุฑุฉ
ููููู ุนุฑุถ ุฌููุน ููุธูู ุดุฑูู ูุนูู:

```bash
# ุงุณุชุจุฏู PARTNER_ID ุจูุนุฑู ุงูุดุฑูู ุงููุนูู
GET http://localhost:3000/api/admin/partners/PARTNER_ID/staff
```

ูุซุงู ุจุงุณุชุฎุฏุงู curl:
```bash
curl http://localhost:3000/api/admin/partners/clxxxx123/staff
```

ุงูุงุณุชุฌุงุจุฉ:
```json
{
  "partner": {
    "id": "clxxxx123",
    "name": "ูุญูุฏ ุนูู"
  },
  "staff": [
    {
      "id": "clyyyy456",
      "name": "ุฃุญูุฏ ูุญูุฏ",
      "email": "ahmed.staff@gmail.com",
      "phone": "01234567890",
      "role": "PARTNER_STAFF",
      "partnerStaffPermissions": {
        "canManageProducts": true,
        "canManageOrders": true,
        "canViewReports": true,
        "canManageInventory": false
      },
      "createdAt": "2024-01-15T10:30:00.000Z"
    }
  ]
}
```

---

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ุญูุงูุฉ API Endpoints
ุฌููุน endpoints ูุญููุฉ ุจู:
- โ ูุตุงุฏูุฉ NextAuth
- โ ุงูุชุญูู ูู ุฏูุฑ ADMIN ููุท
- โ ุชุดููุฑ ูููุงุช ุงููุฑูุฑ ุจู bcrypt

### ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
```typescript
// ูุซุงู: ุงูุชุญูู ูู ุตูุงุญูุฉ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
const user = await prisma.user.findUnique({
  where: { email: session.user.email }
})

if (user.role === 'PARTNER_STAFF') {
  const permissions = user.partnerStaffPermissions as any
  if (!permissions?.canManageProducts) {
    return { error: 'ุบูุฑ ูุตุฑุญ ูู' }
  }
}
```

---

## ๐ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู User (ูุญุฏุซ)
```prisma
model User {
  // ... ุญููู ุฃุฎุฑู
  partnerId        String?        // ูุนุฑู ุงูุดุฑูู (ููููุธููู)
  partnerStaffPermissions Json? // ุตูุงุญูุงุช ุงูููุธู ูู JSON
  partner          PartnerCapital? @relation(fields: [partnerId], references: [id])
}
```

### ุฌุฏูู PartnerCapital (ูุญุฏุซ)
```prisma
model PartnerCapital {
  // ... ุญููู ุฃุฎุฑู
  staffMembers     User[]         // ููุธูู ุงูุดุฑูู
}
```

### UserRole Enum (ูุญุฏุซ)
```prisma
enum UserRole {
  ADMIN
  CUSTOMER
  DELIVERY_STAFF
  VENDOR
  MANUFACTURER
  MARKETING_STAFF
  PARTNER_STAFF   // โ ุฌุฏูุฏ
}
```

---

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
**ุงูุญู**: ุงุณุชุฎุฏู ุจุฑูุฏ ุฅููุชุฑููู ูุฎุชูู.

### ุฎุทุฃ: "ุงูุดุฑูู ุบูุฑ ููุฌูุฏ"
**ุงูุญู**: ุชุญูู ูู ุฃู ูุนุฑู ุงูุดุฑูู ุตุญูุญ ูู ุงูุฑุงุจุท.

### ูุง ูุธูุฑ ุฒุฑ "ุฅุถุงูุฉ ููุธู"
**ุงูุญู**: 
1. ุชุญูู ูู ุฃูู ูุณุฌู ุฏุฎูู ูู ADMIN
2. ูู ุจุชุญุฏูุซ ุงูุตูุญุฉ (Ctrl+F5)
3. ุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก ูู Console

### ุฎุทุฃ ูู Migration
```bash
# ุฅุนุงุฏุฉ ุชุนููู ูุงุนุฏุฉ ุงูุจูุงูุงุช (โ๏ธ Development ููุท!)
npx prisma migrate reset

# ุซู ุชุดุบูู Migrations
npm run prisma:migrate dev
```

---

## ๐ ูุซุงู ุนููู ูุงูู

### 1. ุฅูุดุงุก ุดุฑูู (ุฅุฐุง ูู ููู ููุฌูุฏุงู)
```typescript
// ูู ุตูุญุฉ /admin/partners
// ุงุถุบุท "ุฅุถุงูุฉ ุดุฑูู"
{
  partnerName: "ูุญูุฏ ุนูู",
  email: "mohamed.ali@example.com",
  capitalAmount: 100000,
  capitalPercent: 30,
  createUserAccount: true,
  password: "Partner123!"
}
```

### 2. ุฅุถุงูุฉ ููุธู ููุดุฑูู
```typescript
// ุงุถุบุท "ุฅุถุงูุฉ ููุธู" ูู ุจุทุงูุฉ ุงูุดุฑูู
{
  name: "ุฃุญูุฏ ูุญูุฏ",
  email: "ahmed.staff@gmail.com",
  password: "StaffPass123!",
  phone: "01234567890",
  permissions: {
    canManageProducts: true,
    canManageOrders: true,
    canViewReports: true,
    canManageInventory: false
  }
}
```

### 3. ุชุณุฌูู ุงูุฏุฎูู ูููุธู
```
URL: http://localhost:3000/auth/login
Email: ahmed.staff@gmail.com
Password: StaffPass123!
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุฃููููุงุช ูุณุชุฎุฏูุฉ
- ๐ข **ุฒุฑ ุฅุถุงูุฉ ููุธู**: ุฃุฎุถุฑ ูุน ุฃููููุฉ `UserPlus`
- ๐ก๏ธ **ุงูุตูุงุญูุงุช**: ุฃููููุฉ `Shield` ุฎุถุฑุงุก
- โน๏ธ **ูุนูููุงุช**: ุฃููููุฉ ูุนูููุงุช ุฒุฑูุงุก

### ุชุฏุฑุฌุงุช ุงูุฃููุงู
```css
/* ุฒุฑ ุฅุถุงูุฉ ููุธู */
bg-green-500/10 border-green-500/30 text-green-300 hover:bg-green-500/20

/* Dialog ุงูููุธู */
border-green-500/30

/* ุฒุฑ ุงูุฅุฑุณุงู */
bg-green-600 hover:bg-green-700
```

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู console ุงููุชุตูุญ
2. ุชุญูู ูู logs ุงูู Terminal
3. ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู Prisma Studio
4. ุฑุงุฌุน ูุฐุง ุงูุฏููู ูุฑุฉ ุฃุฎุฑู

---

## โ Checklist ููุชุฌุฑุจุฉ

- [ ] ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช (migrate)
- [ ] ุชุณุฌูู ุงูุฏุฎูู ููุฏูุฑ
- [ ] ูุชุญ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุดุฑูุงุก
- [ ] ุงูุชุญูู ูู ูุฌูุฏ ุฒุฑ "ุฅุถุงูุฉ ููุธู"
- [ ] ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ
- [ ] ุญูุธ ุจูุงูุงุช ุงูุฏุฎูู
- [ ] ุงูุชุญูู ูู ุฑุณุงูุฉ ุงููุฌุงุญ
- [ ] ุงูุชุญูู ูู Console
- [ ] ุงูุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุชุณุฌูู ุงูุฎุฑูุฌ ูู ุงููุฏูุฑ
- [ ] ุชุณุฌูู ุงูุฏุฎูู ูููุธู
- [ ] ุงูุชุญูู ูู ุงูุตูุงุญูุงุช

---

## ๐ ูุฌุญ ุงูุชุทุจูู!

ุฅุฐุง ูุฌุญุช ุฌููุน ุงูุฎุทูุงุชุ ูุฃูุช ุงูุขู ูุฏูู:
โ ูุธุงู ููุธููู ูุชูุงูู ููุดุฑูุงุก
โ ุตูุงุญูุงุช ูุงุจูุฉ ููุชุฎุตูุต
โ ูุงุฌูุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู
โ API ูุญููุฉ ุจุงููุงูู

---

## ๐ ูููุงุช ุชู ุชุนุฏูููุง/ุฅูุดุงุคูุง

1. **prisma/schema.prisma**
   - ุฅุถุงูุฉ ุฏูุฑ PARTNER_STAFF
   - ุฅุถุงูุฉ ุญููู partnerId ู partnerStaffPermissions
   - ุฅุถุงูุฉ ุนูุงูุฉ staffMembers

2. **src/app/api/admin/partners/[id]/staff/route.ts**
   - API ูุฅุถุงูุฉ ููุธู (POST)
   - API ูุนุฑุถ ููุธูู ุงูุดุฑูู (GET)

3. **src/app/admin/partners/page.tsx**
   - ุฅุถุงูุฉ State ููููุธููู
   - ุฅุถุงูุฉ ุฒุฑ "ุฅุถุงูุฉ ููุธู"
   - ุฅุถุงูุฉ Dialog ูุฅุถุงูุฉ ุงูููุธู
   - ุฅุถุงูุฉ ูุธุงุฆู ุงููุนุงูุฌุฉ

4. **PARTNER_STAFF_GUIDE.md**
   - ูุฐุง ุงูุฏููู ุงูุดุงูู

---

**๐ฏ ููุงุญุธุฉ ููุงุฆูุฉ**: ูุฐุง ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูููุฑู! ููุท ุงุชุจุน ุงูุฎุทูุงุช ุฃุนูุงู ูุณุชุชููู ูู ุฅุถุงูุฉ ููุธููู ููุดุฑูุงุก ุจุณูููุฉ.
